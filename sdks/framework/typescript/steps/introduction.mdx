---
title: "Step Interface"
---

<RequestExample>
    ```typescript Control Schema
    await step.email('stepId', resolver, {
        controlSchema: z.object({
            subject: z.string(),
            components: z.array(z.object({
                type: z.enum(['text', 'button']),
                content: z.string(),
            })),
        }),
    });
    ```
    ```typescript Skip
    await step.email('stepId', resolver, {
        skip: async (controls) => true,
    });
    ```
    ```typescript Provider Overrides
    await step.email('stepId', resolver, {
      providers: {
        slack: ({ controls, outputs }) => {
          return {
            text: 'A new post has been created',
            blocks: [{
              type: 'section',
              text: {
                  type: 'mrkdwn',
                  text: 'A new post has been created',
              },
            }],
          };
        }
      }
    });
    ```
    ```typescript Provider Passthrough
    await step.email('stepId', resolver, {
      providers: {
        sendgrid: ({ controls, outputs }) => {
          return {
            _passthrough: {
              body: {
                ip_pool_name: 'my-ip-pool',
              },
              headers: {
                'Authorization': 'Bearer my-api-key',
              },
              query: {
                'queryParam': 'queryValue',
              },
            }
          };
        }
      }
    });
    ```
</RequestExample>

## Channel Steps Interface

All channels follow the same shared interface:

<ParamField path="stepId" type="string" required>
  This is the unique identifier for the step in the workflow context. It is used
  to reference and display the step in the dashboard interface.
</ParamField>

<ParamField path="resolver" type="Promise" required>
  This is an async function that returns the content of the step which called
  `Outputs`. Each channel has its own output schema.
</ParamField>

<ParamField path="options" type="StepOptions">
  Additional step configuration.
</ParamField>

## Options Object

This is an optional configuration object that defines: [Controls Schema](/framework/concepts/inputs), [Provider Overrides](#provider-overrides), skip and other configurations.

<ResponseField
  name="skip"
  type="(controls: InferProperties<controlSchema>) => boolean | Promise<boolean>"
>
  A function that returns a boolean value to skip the step. This is helpful when
  you want to use previous step results or other custom logic to skip the step
  from executing.
</ResponseField>

<ResponseField name="controlSchema" type="JSON Schema | Zod">
  This defined the UI Controls exposed in the dashboard for the step. They can
  be nested and of any JSON Schema supported structure.
</ResponseField>

<ResponseField name="providers" type="ProvidersOverride">
  This object used to access and override the underlying deliver providers SDKs. This is useful when you want to customize the content of the notification with properties that are unique to the provider.
</ResponseField>

### Providers Overrides Object

This object used to access and override the underlying deliver providers SDKs. This is useful when you want to customize the content of the notification with properties that are unique to the provider.

An example of this is the `slack` provider, which allows you to customize the content of the notification with Slack `blocks` to create a rich notification experience.

```typescript
type ProvidersOverride = {
  [key: ProviderEnum]: ProviderCallback;
};

type ProviderCallback = (
  params: ProviderOverridesParams
) => ProviderOverrideOutput | Promise<ProviderOverrideOutput>;

type ProviderOverridesParams = {
  controls: StepControls;
  output: StepOutput;
};

type ProviderOverrideOutput = {
  // A map of the properties used by the Provider.
  // These properties are strongly typed and validated
  // against the underlying provider SDK.
  [key in KnownProviderKey]: KnownProviderValue;
  // The passthrough object is used to pass through
  // the original request to the provider.
  // These properties are not validated.
  _passthrough?: {
    body: Record<string, unknown>;
    headers: Record<string, unknown>;
    query: Record<string, unknown>;
  };
};
```

The `_passthrough` object and the known provider values are deeply merged prior to sending the request to the provider, with the `_passthrough` object taking precedence.


### Workflow Channel Preferences

By default, Novu will show the subscriber preferences in the Inbox component. Subscribers can enable and disable any active channel in the workflow using subscriber preferences.
With Workflow channel preferences, you can control the default preference for a channel and whether a subscriber can change it.

In the channels object, you can specify In-App, SMS, Email, Chat, and Push channel preferences. Each channel takes an object with an optional `enabled` flag that controls whether a notification delivery channel is enabled or disabled by default for subscribers.
The `readOnly` property controls if subscribers can change if a channel is enabled/disabled. 

The `readOnly` and `enabled` fields on the `workflow` object are used as fallback values if a channel is not specified explicitly in `channels`.

By default, `enabled` is `true` and `readOnly` is `false` at both the `workflow` and `channels` level.

These preferences can also be controlled from the Novu Dashboard on a workflow. To do so, click on the cog icon at the top right of your screen, and then select the  "Preferences" tab.

<Tabs>
<Tab title="In-App Only - Editable">
```typescript
const newWorkflow = workflow(
  'only-in-app-channel',
  async ({ step }) => {
    await step.inApp('send-in-app', () => ({
      body: 'Hello there',
    }));
  },
  {
    preferences: {
      {
        workflow: { enabled: false },
        channels: {
          inApp: { enabled: true },
        },
      }
    },
  }
);
```
</Tab>
<Tab title="All Enabled - Editable">
```typescript
const newWorkflow = workflow(
  'all-enabled-editable',
  async ({ step }) => {
    await step.inApp('send-in-app', () => ({
      body: 'Hello there',
    }));
  },
  {
    preferences: {
      {
        workflow: { enabled: true },
      }
    },
  }
);
```
</Tab>
<Tab title="All Enabled - Read Only">
```typescript
const newWorkflow = workflow(
  'all-enabled-read-only',
  async ({ step }) => {
    await step.inApp('send-in-app', () => ({
      body: 'Hello there',
    }));
  },
  {
    preferences: {
      {
        workflow: { enabled: true, readOnly: true },
      }
    },
  }
);
```
</Tab>
<Tab title="All Disabled - Editable">
```typescript
const newWorkflow = workflow(
  'all-disabled-editable',
  async ({ step }) => {
    await step.inApp('send-in-app', () => ({
      body: 'Hello there',
    }));
  },
  {
    preferences: {
      {
        workflow: { enabled: false, readOnly: false },
      }
    },
  }
);
```
</Tab>
<Tab title="In-App Disabled - Editable">
```typescript
const newWorkflow = workflow(
  'in-app-disabled-editable',
  async ({ step }) => {
    await step.inApp('send-in-app', () => ({
      body: 'Hello there',
    }));
  },
  {
    preferences: {
      {
        channels: {
          inApp: { enabled: false },
        },
      }
    },
  }
);
```
</Tab>
</Tabs>
